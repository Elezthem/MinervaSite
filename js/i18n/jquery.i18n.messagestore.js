(function($){'use strict';var MessageStore=function(){this.messages={};this.sources={};};function jsonMessageLoader(url){var deferred=$.Deferred();$.getJSON(url).done(deferred.resolve).fail(function(jqxhr,settings,exception){$.i18n.log('Error in loading messages from '+url+' Exception: '+exception);deferred.resolve();});return deferred.promise();}
MessageStore.prototype={load:function(source,locale){var key=null,deferreds=[],messageStore=this;if(typeof source==='string'){$.i18n.log('Loading messages from: '+source);return jsonMessageLoader(source).then(function(localization){return messageStore.load(localization,locale);});}
if(locale){messageStore.set(locale,source);return $.Deferred().resolve();}else{for(key in source){if(Object.prototype.hasOwnProperty.call(source,key)){locale=key;deferreds.push(messageStore.load(source[key],locale));}}
return $.when.apply($,deferreds);}},set:function(locale,messages){if(!this.messages[locale]){this.messages[locale]=messages;}else{this.messages[locale]=$.extend(this.messages[locale],messages);}},get:function(locale,messageKey){return this.messages[locale]&&this.messages[locale][messageKey];}};$.extend($.i18n.messageStore,new MessageStore());}(jQuery));